{"version":3,"file":"rules-editor.esm.js","sources":["../src/ace-wrapper.js","../src/engine-wrapper.js","../src/default_highlight_rules.js","../src/default_fold.js","../src/debounce.js","../src/default_mode.js","../src/resource_highlight_rules.js","../src/resource_fold.js","../src/resource_mode.js","../src/code-editor.js","../src/dynamic-mode.js"],"sourcesContent":["// import ace from \"ace-builds\";\r\nconst ace = window.ace\r\n// import { Range, EditSession, UndoManager } from \"ace-builds\";\r\nconst { Range, EditSession, UndoManager } = ace\r\n/*import \"ace-builds/src-noconflict/theme-cobalt.js\";\r\nimport \"ace-builds/src-noconflict/theme-merbivore_soft.js\";\r\nimport \"ace-builds/src-noconflict/theme-monokai.js\";\r\nimport \"ace-builds/src-noconflict/theme-tomorrow_night_blue.js\";\r\nimport \"ace-builds/src-noconflict/theme-twilight.js\";\r\nimport \"ace-builds/src-noconflict/theme-solarized_light.js\";\r\nimport \"ace-builds/src-noconflict/theme-ambiance.js\";\r\nimport \"ace-builds/src-noconflict/theme-chrome.js\";\r\nimport \"ace-builds/src-noconflict/theme-textmate.js\";\r\nimport \"ace-builds/webpack-resolver\";\r\nconst path = \"ace-builds/src-noconflict/\";\r\nace.config.set(\"basePath\", path);*/\r\nconst TextHighlightRules = ace.require(\r\n    \"ace/mode/text_highlight_rules\"\r\n).TextHighlightRules;\r\n\r\nconst TextMode = ace.require(\"ace/mode/text\").Mode;\r\nconst BaseFoldMode = ace.require(\"ace/mode/folding/fold_mode\").FoldMode;\r\nconst TokenIterator = ace.require(\"ace/token_iterator\").TokenIterator;\r\n// console.log(TextMode);\r\n// const JSONMode = ace.require(\"ace/mode/json\").Mode;\r\nconst Themes = {\r\n    light: [\"Solarized Light\", \"Ambience\", \"Chrome\", \"Textmate\"],\r\n    dark: [\r\n        \"Cobalt\",\r\n        \"Merbivore Soft\",\r\n        \"Monokai\",\r\n        \"Tomorrow night blue\",\r\n        \"Twilight\",\r\n    ],\r\n    // default: ace.require('ace/theme/ambiance'),\r\n};\r\n\r\n// import modes that you want to include into your main bundle\r\n// import 'ace-builds/src-noconflict/mode-javascript'\r\n// import webpack resolver to dynamically load modes, you need to install file-loader for this to work!\r\n// import 'ace-builds/webpack-resolver'\r\n\r\n// if you want to allow dynamic loading of only a few modules use setModuleUrl for each of them manually\r\n// import jsWorkerUrl from 'file-loader!../../build/src-noconflict/worker-javascript';\r\n// ace.config.setModuleUrl('ace/mode/javascript_worker', jsWorkerUrl)\r\n\r\n// import {Mode as JSMode} from '../../build/src-noconflict/mode-javascript'\r\n// editor.setMode( new JSMode())\r\n\r\n// const EditSession = ace.EsitSession //ace.require('ace/edit_session').EditSession\r\n// const UndoManager = ace.UndoManager //ace.require('ace/undomanager').UndoManager\r\n// const BaseFoldMode = ace.require('ace/mode/folding/fold_mode').FoldMode\r\n// const TokenIterator = ace.require('ace/token_iterator').TokenIterator\r\n\r\n// const TextMode = require('ace-builds/src-noconflict/mode-text').Mode\r\n// import * as TextNode from 'ace-builds/src-noconflict/mode-text'\r\n\r\nexport {\r\n    ace,\r\n    Range,\r\n    EditSession,\r\n    UndoManager,\r\n    BaseFoldMode,\r\n    TokenIterator,\r\n    TextHighlightRules,\r\n    TextMode,\r\n    // JSONMode,\r\n    Themes,\r\n};\r\n","// import { ResParser, Parser, Keywords } from 'rules-engine'\r\nimport { Rules } from \"rules-engine\";\r\n\r\nRules.init([\"fr\", \"de\"]);\r\n\r\nexport default Rules;\r\n","/* jslint esversion:8 */\r\nimport * as wrapper from \"./ace-wrapper\";\r\nimport Rules from \"./engine-wrapper\";\r\nconst TextHighlightRules = wrapper.TextHighlightRules;\r\n// var rules = null;\r\nconst mode = \"ace/mode/kbf\";\r\n\r\nclass HighlightRules extends TextHighlightRules {\r\n    constructor(language) {\r\n        super();\r\n        this.keywords = {};\r\n        this.rules = new Rules(language, mode);\r\n        this.setLanguage(language);\r\n    }\r\n    getRules() {\r\n        return {\r\n            start: [\r\n                {\r\n                    token: \"comment\",\r\n                    regex: /\\/\\/.*$/,\r\n                },\r\n                {\r\n                    token: \"comment\", // multi line comment\r\n                    regex: /\\/\\*/,\r\n                    next: \"comment\",\r\n                },\r\n                {\r\n                    token: \"string\", // character\r\n                    regex: /'(?:.|\\\\(:?u[\\da-fA-F]+|x[\\da-fA-F]+|[tbrf'\"n]))?'/,\r\n                },\r\n                { token: \"string\", regex: \"`\", next: \"string\" },\r\n                { token: \"string\", regex: \"'\", next: \"qstring\" },\r\n                {\r\n                    token: \"constant.numeric\", // hex\r\n                    regex: \"0[xX][0-9a-fA-F]+\\\\b\",\r\n                },\r\n                {\r\n                    token: \"constant.numeric\", // float\r\n                    regex: /[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b/,\r\n                },\r\n                {\r\n                    token: \"punctuation.operator\",\r\n                    regex: /\\?|\\:|\\,|\\;|\\./,\r\n                },\r\n                {\r\n                    token: \"paren.lparen\",\r\n                    regex: \"[[({]\",\r\n                },\r\n                {\r\n                    token: \"paren.rparen\",\r\n                    regex: \"[\\\\])}]\",\r\n                },\r\n                {\r\n                    token: \"text\",\r\n                    regex: /\\s+/,\r\n                },\r\n                {\r\n                    token: \"keyword.operator\",\r\n                    regex: /[-+%=<>*]|[~:,.&!^]/,\r\n                },\r\n                {\r\n                    token: \"keyword.operator\",\r\n                    regex: \"abs sign ceil floor trunc frac acos asin atan cos sin tan cosh sinh tanh exp log log10 sqrt pi\"\r\n                        .split(\" \")\r\n                        .join(\"|\"),\r\n                },\r\n                {\r\n                    token: (value) => {\r\n                        const found = this.keywordEntries.find((entry) => {\r\n                            return (\r\n                                entry[1].toLowerCase() === value.toLowerCase()\r\n                            );\r\n                        });\r\n                        if (found) {\r\n                            switch (found[0]) {\r\n                                case \"TRUE\":\r\n                                case \"FALSE\":\r\n                                case \"YES\":\r\n                                case \"NO\":\r\n                                    return \"constant.language.boolean\";\r\n                                case \"OR\":\r\n                                case \"AND\":\r\n                                case \"IF\":\r\n                                case \"ELSE\":\r\n                                case \"ELSEIF\":\r\n                                case \"THEN\":\r\n                                    return \"keyword.control\";\r\n                                case \"DIGIT\":\r\n                                case \"TEXT\":\r\n                                case \"MENU\":\r\n                                case \"NUMBER\":\r\n                                    return \"constant.language\";\r\n                                default:\r\n                                    return \"keyword.other\";\r\n                            }\r\n                        } else {\r\n                            return \"text\";\r\n                        }\r\n                    },\r\n                    regex: new RegExp(/\\b\\w+\\b/),\r\n                },\r\n                {\r\n                    caseInsensitive: true,\r\n                },\r\n                // this.keywordRule\r\n            ],\r\n            qstring: [\r\n                { token: \"constant.language.escape\", regex: /''/ },\r\n                { token: \"string\", regex: \"'\", next: \"start\" },\r\n                { defaultToken: \"string\" },\r\n            ],\r\n            string: [\r\n                { token: \"constant.language.escape\", regex: /``/ },\r\n                { token: \"string\", regex: \"`\", next: \"start\" },\r\n                { defaultToken: \"string\" },\r\n            ],\r\n            comment: [\r\n                {\r\n                    token: \"comment\", // closing comment\r\n                    regex: \"\\\\*\\\\/\",\r\n                    next: \"start\",\r\n                },\r\n                {\r\n                    defaultToken: \"comment\",\r\n                },\r\n            ],\r\n        };\r\n    }\r\n    // Set language definition dynamically at run time\r\n    setLanguage(language) {\r\n        this.keywords = this.rules.getKeywords();\r\n        if (!this.keywords) {\r\n            throw new Error(\"Language not supported yet: \" + language || \"\");\r\n        }\r\n        this.keywordEntries = Object.entries(this.keywords);\r\n        this.$rules = this.getRules();\r\n        this.normalizeRules();\r\n        // this.embedRules(DocCommentHighlightRules, \"doc-\", [ DocCommentHighlightRules.getEndRule(\"start\") ]);\r\n    }\r\n}\r\n\r\nexport default HighlightRules;\r\n","/* jslint esversion:6 */\r\nimport * as wrapper from './ace-wrapper'\r\nconst {\r\n  Range,\r\n  BaseFoldMode,\r\n  TokenIterator,\r\n} = wrapper\r\n// ace.config.set('basePath', '../node_mdules/ace-builds/src-noconflict')\r\n// ace.config.set('basePath', '../lib/ace-builds/src-noconflict')\r\n// require('ace-builds/webpack-resolver')\r\n// const Range = ace.Range\r\n// const BaseFoldMode = ace.require('ace/mode/folding/fold_mode').FoldMode\r\n// const TokenIterator = ace.require('ace/token_iterator').TokenIterator\r\nconst fold = {\r\n  en: {\r\n    foldingStartMarker: /\\b^\\s*(?:rule|prompt|summary)\\b/i,\r\n    foldingStopMarker: /\\b^\\s*(?:prompt|rule|max|min|text|digit|yes\\/no)\\b/ig,\r\n    foldingStopMenu: /\\b^\\s*(?:max|min|text|digit|yes\\/no)\\b/ig,\r\n  },\r\n  fr: {\r\n    foldingStartMarker: /\\b^\\s*(?:rule|prompt|summary)\\b/i,\r\n    foldingStopMarker: /\\b^\\s*(?:prompt|rule|max|min|text|digit|yes\\/no)\\b/ig,\r\n    foldingStopMenu: /\\b^\\s*(?:max|min|text|digit|yes\\/no)\\b/ig,\r\n  },\r\n}\r\n\r\nexport default class extends BaseFoldMode {\r\n  constructor () {\r\n    super()\r\n    // regular expressions that identify starting and stopping points\r\n    this.foldingStartMarker = fold.en.foldingStartMarker\r\n    this.foldingStopMarker = fold.en.foldingStopMarker\r\n    this.foldingStopMenu = fold.en.foldingStopMenu\r\n\r\n    this.getFoldWidgetRange = (session, _foldStyle, row) => {\r\n      const lang = session.language\r\n      var line = session.getLine(row)\r\n      switch (lang) {\r\n      default:\r\n        this.foldingStartMarker = fold[lang].foldingStartMarker // /\\b^\\s*(?:rule|prompt|summary|if|then|else)\\b/;\r\n        this.foldingStopMarker = fold[lang].foldingStopMarker /// \\b^\\s*(?:rule|prompt)\\b/;\r\n        this.foldingStopMenu = fold[lang].foldingStopMenu\r\n      }\r\n      var matchStart = line.match(this.foldingStartMarker)\r\n      if (matchStart) {\r\n        // var i = matchStart.index;\r\n        // if (match[0]) {\r\n        var position = { row: row, column: line.length }\r\n        var iterator = new TokenIterator(session, position.row, position.column)\r\n        var token = iterator.getCurrentToken()\r\n        var seek = this.foldingStopMarker\r\n\r\n        while (token) {\r\n          if (token.value.match(seek)) {\r\n            const currentRow = iterator.getCurrentTokenRow()\r\n            return Range.fromPoints(position, {\r\n              row: token.value.match(this.foldingStopMenu) ? currentRow : currentRow - 1,\r\n              column: iterator.getCurrentTokenColumn(),\r\n            })\r\n          }\r\n          token = iterator.stepForward()\r\n        }\r\n        // }\r\n      }\r\n      // test each line, and return a range of segments to collapse\r\n      return null\r\n    }\r\n  }\r\n}\r\n","function debounce (func, wait, immediate) {\r\n  var timeout\r\n  return function () {\r\n    var context = this; var args = arguments\r\n    var later = function () {\r\n      timeout = null\r\n      if (!immediate) func.apply(context, args)\r\n    }\r\n    var callNow = immediate && !timeout\r\n    clearTimeout(timeout)\r\n    timeout = setTimeout(later, wait)\r\n    if (callNow) func.apply(context, args)\r\n  }\r\n}\r\n\r\nexport default debounce\r\n\r\n/* Usage\r\nvar myEfficientFn = debounce(function() {\r\n\t// All the taxing stuff you do\r\n}, 250);\r\n\r\nwindow.addEventListener('resize', myEfficientFn);\r\n*/\n","/* jslint esversion:8 */\r\nimport { TextMode } from \"./ace-wrapper\";\r\n\r\nimport Rules from \"./engine-wrapper\";\r\nimport HighlightRules from \"./default_highlight_rules\";\r\nimport DefaultFoldMode from \"./default_fold\";\r\nimport debounce from \"./debounce\";\r\n// const ace = require('ace-builds/src-noconflict/ace')\r\n// ace.config.set('basePath', '../node_mdules/ace-builds/src-noconflict')\r\n// const TextMode = ace.require('ace/mode/text').Mode\r\n\r\nexport default class extends TextMode {\r\n    constructor(editor, watch = true) {\r\n        super();\r\n        this.lineCommentStart = \"//\";\r\n        this.blockComment = { start: \"/*\", end: \"*/\" };\r\n        this.editor = editor;\r\n        this.language = editor.session.language;\r\n        this.$highlightRules = new HighlightRules(this.language);\r\n        // If static highlighter, do not watch for changes\r\n        this.$id = \"ace/mode/kbf\";\r\n        this.rules = new Rules(this.editor.session.language || \"en\", this.$id);\r\n        if (watch) this.watch();\r\n    }\r\n\r\n    watch() {\r\n        this.foldingRules = new DefaultFoldMode();\r\n        this.editor.on(\r\n            \"change\",\r\n            debounce(async () => {\r\n                const value = this.editor.getValue();\r\n                try {\r\n                    const errors = await this.rules.parse(value);\r\n                    this.editor.session.clearAnnotations();\r\n                    this.editor.session.setAnnotations(errors);\r\n                } catch (e) {\r\n                    // this.editor.session.setAnnotations(errors)\r\n                    console.log(e);\r\n                }\r\n            }, 1000)\r\n        );\r\n    }\r\n}\r\n","/* jslint esversion:8 */\r\nimport * as wrapper from \"./ace-wrapper\";\r\nconst { TextHighlightRules } = wrapper;\r\n// const TextHighlightRules = ace.require('ace/mode/text_highlight_rules').TextHighlightRules\r\n\r\nclass HighlightRules extends TextHighlightRules {\r\n    constructor() {\r\n        super();\r\n        this.$rules = {\r\n            start: [\r\n                {\r\n                    token: \"comment\",\r\n                    regex: /\\/\\/.*$/,\r\n                },\r\n                {\r\n                    token: \"comment\", // multi line comment\r\n                    regex: /\\/\\*/,\r\n                    next: \"comment\",\r\n                },\r\n                { token: \"string\", regex: \"`\", next: \"string\" },\r\n                { token: \"string\", regex: \"'\", next: \"qstring\" },\r\n                {\r\n                    token: \"constant.numeric\", // hex\r\n                    regex: /0[xX][0-9a-fA-F]+\\b/,\r\n                },\r\n                {\r\n                    token: \"constant.numeric\", // float\r\n                    regex: /[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b/,\r\n                },\r\n                {\r\n                    token: \"keyword.operator\",\r\n                    regex: /\\W[-+%=<>*]\\W|\\*\\*|[~:,.&$]|->*?|=>/,\r\n                },\r\n                {\r\n                    token: \"paren.lparen\",\r\n                    regex: /[\\[(\\{]/,\r\n                },\r\n                {\r\n                    token: \"paren.rparen\",\r\n                    regex: /[\\])\\}]/,\r\n                },\r\n\r\n                {\r\n                    token: \"keyword\",\r\n                    regex: /[^=]+(?:[=:])/,\r\n                },\r\n                {\r\n                    token: \"punctuation.operator\",\r\n                    regex: /\\?[:,;=\\.]/,\r\n                },\r\n                {\r\n                    caseInsensitive: true,\r\n                },\r\n            ],\r\n            qstring: [\r\n                { token: \"constant.language.escape\", regex: /''/ },\r\n                { token: \"string\", regex: \"'\", next: \"start\" },\r\n                { defaultToken: \"string\" },\r\n            ],\r\n            string: [\r\n                { token: \"constant.language.escape\", regex: /``/ },\r\n                { token: \"string\", regex: \"`\", next: \"start\" },\r\n                { defaultToken: \"string\" },\r\n            ],\r\n            comment: [\r\n                {\r\n                    token: \"comment\", // closing comment\r\n                    regex: /\\*\\//,\r\n                    next: \"start\",\r\n                },\r\n                {\r\n                    defaultToken: \"comment\",\r\n                },\r\n            ],\r\n        };\r\n    }\r\n}\r\n// \"variable.language\": \"this\",\r\n// \"constant.language\": \"TRUE FALSE NULL SPACE\",\r\nexport default new HighlightRules();\r\n","/* jslint esversion:6 */\r\nimport * as wrapper from './ace-wrapper'\r\nconst {\r\n  Range,\r\n  BaseFoldMode,\r\n  TokenIterator,\r\n} = wrapper\r\n\r\n// const Range = ace.Range\r\n// const BaseFoldMode = ace.require('ace/mode/folding/fold_mode').FoldMode\r\n// const TokenIterator = ace.require('ace/token_iterator').TokenIterator\r\n\r\nexport default class extends BaseFoldMode {\r\n  constructor () {\r\n    super()\r\n    // regular expressions that identify starting and stopping points\r\n    this.foldingStartMarker = /^\\s*\\/\\/[^-]+$/\r\n    this.foldingStopMarker = /^\\s*--/\r\n\r\n    this.getFoldWidgetRange = (session, _foldStyle, row) => {\r\n      var line = session.getLine(row)\r\n      var matchStart = line.match(this.foldingStartMarker)\r\n      if (matchStart) {\r\n        var position = { row: row, column: line.length }\r\n        var iterator = new TokenIterator(session, position.row, position.column)\r\n        var token = iterator.getCurrentToken()\r\n        var seek = this.foldingStopMarker\r\n\r\n        while (token) {\r\n          if (token.value.match(seek)) {\r\n            const currentRow = iterator.getCurrentTokenRow()\r\n            return Range.fromPoints(position, {\r\n              row: currentRow,\r\n              column: iterator.getCurrentTokenColumn(),\r\n            })\r\n          }\r\n          token = iterator.stepForward()\r\n        }\r\n        // }\r\n      }\r\n      // test each line, and return a range of segments to collapse\r\n      return null\r\n    }\r\n  }\r\n}\r\n","import { TextMode } from \"./ace-wrapper\";\r\n// import { ResParser as Parser } from './engine-wrapper'\r\n// import { rules as Rule } from './engine-wrapper'\r\nimport Rules from \"./engine-wrapper\";\r\nimport debounce from \"./debounce\";\r\nimport HighlightRules from \"./resource_highlight_rules\";\r\nimport DefaultFoldMode from \"./resource_fold\";\r\n// const ace = require('ace-builds/src-noconflict/ace')\r\n// const TextMode = ace.require('ace/mode/text').Mode\r\nexport default class extends TextMode {\r\n    constructor(editor, onlyHighlight = false) {\r\n        super();\r\n        this.$highlightRules = this.HighlightRules = HighlightRules;\r\n        this.foldingRules = new DefaultFoldMode();\r\n        this.editor = editor;\r\n        this.language = editor.session.language;\r\n        this.$id = \"ace/mode/res\";\r\n        this.rules = new Rules(this.editor.session.language || \"en\", this.$id);\r\n        // If static highlighter, do not watch for changes\r\n        if (!onlyHighlight) this.watch();\r\n    }\r\n\r\n    watch() {\r\n        // this.parser = new Parser(this.editor.session.language || 'en')\r\n        // this.parser.on('done', (errors) => {\r\n        // this.editor.session.setAnnotations(errors)\r\n        // })\r\n        this.editor.on(\r\n            \"change\",\r\n            debounce(async () => {\r\n                const value = this.editor.getValue();\r\n                try {\r\n                    const errors = await this.rules.parse(value);\r\n                    this.editor.session.clearAnnotations();\r\n                    this.editor.session.setAnnotations(errors);\r\n                } catch (e) {\r\n                    // this.editor.session.setAnnotations(errors)\r\n                    console.log(e);\r\n                }\r\n            }, 1000)\r\n        );\r\n    }\r\n}\r\n","import { ace, EditSession, UndoManager, Themes } from \"./ace-wrapper\";\r\n\r\nimport Mode from \"./default_mode\";\r\nimport ResourceMode from \"./resource_mode\";\r\nimport dynamicMode from \"./dynamic-mode\";\r\n\r\nclass CodeEditor {\r\n    constructor() {\r\n        if (!CodeEditor.instance) {\r\n            CodeEditor.instance = this;\r\n        }\r\n        this.language = \"en\";\r\n        this.editors = [];\r\n        this.defaults = {\r\n            fontSize: 18,\r\n            fontName: \"Courier New\",\r\n            theme: \"ace/theme/tomorrow_night_blue\",\r\n        };\r\n        this.theme = this.defaults.theme; // 'ace/theme/tomorrow_night_blue'\r\n        this.fontSize = this.defaults.fontSize;\r\n        this.fontName = this.defaults.fontName;\r\n\r\n        return CodeEditor.instance;\r\n    }\r\n\r\n    setHighlightRule(editor, fileName) {\r\n        // return this.setHighlightRules(editor, mode)\r\n        const ext = fileName\r\n            ? fileName.substring(fileName.indexOf(\".\"))\r\n            : \".kbf\";\r\n        let defaultMode = null;\r\n        if (ext === \".kbf\") {\r\n            defaultMode = new Mode(editor);\r\n        } else if (ext === \".res\") {\r\n            defaultMode = new ResourceMode(editor);\r\n        } else {\r\n            const modePath = dynamicMode(fileName);\r\n            const DynamicMode = ace.require(modePath).Mode;\r\n            editor.session.setMode(new DynamicMode());\r\n        }\r\n\r\n        editor.session.setMode(defaultMode, () => {\r\n            editor.session.bgTokenizer.start(0);\r\n        });\r\n    }\r\n\r\n    edit(element, options = {}) {\r\n        let el = null;\r\n        if (typeof element === \"string\") {\r\n            el =\r\n                document.getElementById(element) ||\r\n                document.querySelector(element);\r\n        } else if (element && (element.id || element.tagName)) {\r\n            el = element;\r\n        }\r\n        if (!el) {\r\n            console.error(\"Invalid container reference: \" + el);\r\n            return null;\r\n        }\r\n        if (typeof options !== \"object\") {\r\n            console.error(\"Invalid options parameter : \" + options);\r\n            return null;\r\n        }\r\n\r\n        let editor = null;\r\n        const session = new EditSession(options.text ? options.text : \"\");\r\n        session.language = options.language ? options.language : this.language;\r\n        session.setUndoManager(new UndoManager());\r\n\r\n        const editorSettings = {\r\n            fontSize: options.fontSize || this.fontSize,\r\n            fontFamily: options.fontName || this.fontName,\r\n            theme: options.theme || this.theme,\r\n            showLineNumbers: true,\r\n            readOnly: false,\r\n            showGutter: true,\r\n            animatedScroll: true,\r\n            minLines: 5,\r\n            maxLines: 'auto',\r\n            selectionStyle: \"row\",\r\n            highlightActiveLine: true,\r\n            showPrintMargin: true,\r\n        };\r\n\r\n        editor = ace.edit(el, Object.assign(editorSettings, options));\r\n        editor.data = options.data || {};\r\n        editor.setSession(session);\r\n        editor.renderer.setScrollMargin(10, 10, 10, 10);\r\n        editor.$blockScrolling = Infinity;\r\n        editor.setOptions({\r\n            scrollPastEnd: 0.9,\r\n            autoScrollEditorIntoView: true,\r\n        });\r\n        editor.focus();\r\n        // editor.select()\r\n        // editor.gotoLine(0)\r\n        // editor.blur(true)\r\n        // this.editor.session.selection.on('changeSelection', function(){});\r\n        // this.editor.session.selection.on('changeCursor', function(){});\r\n        this.setHighlightRule(editor, options.fileName);\r\n        this.editors.push(editor);\r\n        setTimeout(() => {\r\n            // let sel = editor.selection\r\n            // sel.clearSelection()\r\n            editor.clearSelection();\r\n        }, 0);\r\n\r\n        return editor;\r\n    }\r\n\r\n    reset() {\r\n        this.FontSize = this.defaults.fontSize;\r\n        this.FontName = this.defaults.fontName;\r\n        this.Theme = this.defaults.theme;\r\n    }\r\n    destroy() {\r\n        this.editors.forEach((editor) => {\r\n            editor.destroy();\r\n            editor.container.remove();\r\n        });\r\n    }\r\n    get ThemeList() {\r\n        return Themes;\r\n    }\r\n    set Theme(val) {\r\n        if (!val) {\r\n            console.log(\"Theme not set\");\r\n            return;\r\n        }\r\n        let theme = val && val.toLowerCase();\r\n        if (\r\n            this.Themes.dark.find(\r\n                (item) => item.toLowerCase() === theme.toLocaleLowerCase()\r\n            ) ||\r\n            this.Themes.light.find(\r\n                (item) => item.toLowerCase() === theme.toLocaleLowerCase()\r\n            )\r\n        ) {\r\n            this.theme = \"ace/theme/\" + theme.replace(/\\s+/g, \"_\");\r\n            this.editors.forEach((editor) => editor.setTheme(this.theme));\r\n        }\r\n    }\r\n    get Theme() {\r\n        return this.theme;\r\n    }\r\n    get FontName() {\r\n        return this.fontName;\r\n    }\r\n    set FontName(value) {\r\n        this.fontName = value;\r\n    }\r\n    get FontSize() {\r\n        return this.fontSize;\r\n    }\r\n    set FontSize(value) {\r\n        this.fontSize = value;\r\n    }\r\n    get Editors() {\r\n        return this.editors;\r\n    }\r\n}\r\nconst instance = new CodeEditor();\r\nObject.freeze(instance);\r\n\r\n/*  setHighlightRules (editor, language) {\r\n    const lang = language || 'text'\r\n    const session = editor.session\r\n    editor.session.setMode('ace/mode/' + lang, function () {\r\n    const rules = session.$mode.$highlightRules.getRules()\r\n      for (let stateName in rules) {\r\n        if (Object.prototype.hasOwnProperty.call(rules, stateName)) {\r\n          rules[stateName].unshift({\r\n            token: 'keyword',\r\n            regex: /TITLE/,\r\n          }, {\r\n            token: 'constant',\r\n            regex: /GOAL/,\r\n          })\r\n        }\r\n      }\r\n      // console.log(session.$mode)\r\n      // force recreation of tokenizer\r\n      session.$mode.$tokenizer = null\r\n      session.bgTokenizer.setTokenizer(session.$mode.getTokenizer())\r\n      // force re-highlight whole document\r\n      session.bgTokenizer.start(0)\r\n    })\r\n  } */\r\nexport default instance;\r\n","function autoImplementedMode (filename) {\r\n  var ext = filename.split('.').pop()\r\n  var prefix = \"ace/mode/\"\r\n\r\n  if (!ext) {\r\n    return prefix + \"text\"\r\n  }\r\n\r\n  /**\r\n   *  Functional, but inefficient if you want to write it by yourself ....\r\n   */\r\n  switch (ext) {\r\n    case \"js\":\r\n      return prefix + \"javascript\"\r\n    case \"json\":\r\n      return prefix + \"json\"\r\n    default: 'text'\r\n  }\r\n}\r\n\r\n\r\n// var filename = \"myfile.js\"\r\n// In this case \"ace/mode/javascript\"\r\n// var mode = autoImplementedMode(filename)\r\n// editor.getSession().setMode(mode)\r\nexport default autoImplementedMode\r\n"],"names":["ace","window","Range","EditSession","UndoManager","TextHighlightRules","require","TextMode","Mode","BaseFoldMode","FoldMode","TokenIterator","Themes","light","dark","Rules","init","HighlightRules","language","_this","keywords","rules","setLanguage","getRules","start","token","regex","next","split","join","value","found","_this2","keywordEntries","find","entry","toLowerCase","RegExp","caseInsensitive","qstring","defaultToken","string","comment","this","getKeywords","Error","Object","entries","$rules","normalizeRules","wrapper","fold","en","foldingStartMarker","foldingStopMarker","foldingStopMenu","fr","getFoldWidgetRange","session","_foldStyle","row","lang","line","getLine","match","position","column","length","iterator","getCurrentToken","seek","currentRow","getCurrentTokenRow","fromPoints","getCurrentTokenColumn","stepForward","debounce","func","wait","immediate","timeout","context","args","arguments","later","apply","callNow","clearTimeout","setTimeout","editor","watch","lineCommentStart","blockComment","end","$highlightRules","$id","foldingRules","DefaultFoldMode","on","getValue","body","recover","result","parse","errors","clearAnnotations","setAnnotations","e","then","console","log","onlyHighlight","instance","CodeEditor","editors","defaults","fontSize","fontName","theme","setHighlightRule","fileName","ext","substring","indexOf","defaultMode","ResourceMode","modePath","filename","pop","prefix","dynamicMode","DynamicMode","setMode","bgTokenizer","edit","element","options","el","document","getElementById","querySelector","id","tagName","error","text","setUndoManager","assign","fontFamily","showLineNumbers","readOnly","showGutter","animatedScroll","minLines","maxLines","selectionStyle","highlightActiveLine","showPrintMargin","data","setSession","renderer","setScrollMargin","$blockScrolling","Infinity","setOptions","scrollPastEnd","autoScrollEditorIntoView","focus","push","clearSelection","reset","FontSize","FontName","Theme","destroy","forEach","container","remove","val","item","toLocaleLowerCase","replace","setTheme","freeze"],"mappings":"yNACA,IAAMA,EAAMC,OAAOD,IAEXE,EAAoCF,EAApCE,MAAOC,EAA6BH,EAA7BG,YAAaC,EAAgBJ,EAAhBI,YAatBC,EAAqBL,EAAIM,QAC3B,iCACFD,mBAEIE,EAAWP,EAAIM,QAAQ,iBAAiBE,KACxCC,EAAeT,EAAIM,QAAQ,8BAA8BI,SACzDC,EAAgBX,EAAIM,QAAQ,sBAAsBK,cAGlDC,EAAS,CACXC,MAAO,CAAC,kBAAmB,WAAY,SAAU,YACjDC,KAAM,CACF,SACA,iBACA,UACA,sBACA,aC7BRC,EAAMC,KAAK,CAAC,KAAM,OCAlB,IAIMC,cACF,WAAYC,SAAU,OAClBC,sBACKC,SAAW,GAChBD,EAAKE,MAAQ,IAAIN,EAAMG,EANlB,gBAOLC,EAAKG,YAAYJ,uCAErBK,SAAA,sBACI,MAAO,CACHC,MAAO,CACH,CACIC,MAAO,UACPC,MAAO,WAEX,CACID,MAAO,UACPC,MAAO,OACPC,KAAM,WAEV,CACIF,MAAO,SACPC,MAAO,sDAEX,CAAED,MAAO,SAAUC,MAAO,IAAKC,KAAM,UACrC,CAAEF,MAAO,SAAUC,MAAO,IAAKC,KAAM,WACrC,CACIF,MAAO,mBACPC,MAAO,wBAEX,CACID,MAAO,mBACPC,MAAO,8CAEX,CACID,MAAO,uBACPC,MAAO,kBAEX,CACID,MAAO,eACPC,MAAO,SAEX,CACID,MAAO,eACPC,MAAO,WAEX,CACID,MAAO,OACPC,MAAO,OAEX,CACID,MAAO,mBACPC,MAAO,uBAEX,CACID,MAAO,mBACPC,MAAO,iGACFE,MAAM,KACNC,KAAK,MAEd,CACIJ,MAAO,SAACK,GACJ,IAAMC,EAAQC,EAAKC,eAAeC,KAAK,SAACC,GACpC,OACIA,EAAM,GAAGC,gBAAkBN,EAAMM,gBAGzC,IAAIL,EAuBA,MAAO,OAtBP,OAAQA,EAAM,IACV,IAAK,OACL,IAAK,QACL,IAAK,MACL,IAAK,KACD,MAAO,4BACX,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,OACL,IAAK,SACL,IAAK,OACD,MAAO,kBACX,IAAK,QACL,IAAK,OACL,IAAK,OACL,IAAK,SACD,MAAO,oBACX,QACI,MAAO,kBAMvBL,MAAO,IAAIW,OAAO,YAEtB,CACIC,iBAAiB,IAIzBC,QAAS,CACL,CAAEd,MAAO,2BAA4BC,MAAO,MAC5C,CAAED,MAAO,SAAUC,MAAO,IAAKC,KAAM,SACrC,CAAEa,aAAc,WAEpBC,OAAQ,CACJ,CAAEhB,MAAO,2BAA4BC,MAAO,MAC5C,CAAED,MAAO,SAAUC,MAAO,IAAKC,KAAM,SACrC,CAAEa,aAAc,WAEpBE,QAAS,CACL,CACIjB,MAAO,UACPC,MAAO,SACPC,KAAM,SAEV,CACIa,aAAc,gBAM9BlB,YAAA,SAAYJ,GAER,GADAyB,KAAKvB,SAAWuB,KAAKtB,MAAMuB,eACtBD,KAAKvB,SACN,UAAUyB,MAAM,+BAAiC3B,GAAY,IAEjEyB,KAAKV,eAAiBa,OAAOC,QAAQJ,KAAKvB,UAC1CuB,KAAKK,OAASL,KAAKpB,WACnBoB,KAAKM,qBArIcC,GCAzBhD,EAGEgD,EADFvC,EACEuC,EAOEC,EAAO,CACXC,GAAI,CACFC,mBAAoB,mCACpBC,kBAAmB,uDACnBC,gBAAiB,4CAEnBC,GAAI,CACFH,mBAAoB,mCACpBC,kBAAmB,uDACnBC,gBAAiB,2DAKnB,mBAAe,OACbpC,sBAEKkC,mBAAqBF,EAAKC,GAAGC,mBAClClC,EAAKmC,kBAAoBH,EAAKC,GAAGE,kBACjCnC,EAAKoC,gBAAkBJ,EAAKC,GAAGG,gBAE/BpC,EAAKsC,mBAAqB,SAACC,EAASC,EAAYC,GAC9C,IAAMC,EAAOH,EAAQxC,SACjB4C,EAAOJ,EAAQK,QAAQH,GAQ3B,GALEzC,EAAKkC,mBAAqBF,EAAKU,GAAMR,mBACrClC,EAAKmC,kBAAoBH,EAAKU,GAAMP,kBACpCnC,EAAKoC,gBAAkBJ,EAAKU,GAAMN,gBAEnBO,EAAKE,MAAM7C,EAAKkC,oBAS/B,IALA,IAAIY,EAAW,CAAEL,IAAKA,EAAKM,OAAQJ,EAAKK,QACpCC,EAAW,IAAIzD,EAAc+C,EAASO,EAASL,IAAKK,EAASC,QAC7DzC,EAAQ2C,EAASC,kBACjBC,EAAOnD,EAAKmC,kBAET7B,GAAO,CACZ,GAAIA,EAAMK,MAAMkC,MAAMM,GAAO,CAC3B,IAAMC,EAAaH,EAASI,qBAC5B,OAAOtE,EAAMuE,WAAWR,EAAU,CAChCL,IAAKnC,EAAMK,MAAMkC,MAAM7C,EAAKoC,iBAAmBgB,EAAaA,EAAa,EACzEL,OAAQE,EAASM,0BAGrBjD,EAAQ2C,EAASO,cAKrB,gCA3DFzB,GCNJ,SAAS0B,EAAUC,EAAMC,EAAMC,GAC7B,IAAIC,EACJ,kBACE,IAAIC,EAAUtC,KAAUuC,EAAOC,UAC3BC,EAAQ,WACVJ,EAAU,KACLD,GAAWF,EAAKQ,MAAMJ,EAASC,IAElCI,EAAUP,IAAcC,EAC5BO,aAAaP,GACbA,EAAUQ,WAAWJ,EAAON,GACxBQ,GAAST,EAAKQ,MAAMJ,EAASC,sBCCjC,WAAYO,EAAQC,SAAc,gBAAdA,IAAAA,GAAQ,IACxBvE,sBACKwE,iBAAmB,KACxBxE,EAAKyE,aAAe,CAAEpE,MAAO,KAAMqE,IAAK,MACxC1E,EAAKsE,OAASA,EACdtE,EAAKD,SAAWuE,EAAO/B,QAAQxC,SAC/BC,EAAK2E,gBAAkB,IAAI7E,EAAeE,EAAKD,UAE/CC,EAAK4E,IAAM,eACX5E,EAAKE,MAAQ,IAAIN,EAAMI,EAAKsE,OAAO/B,QAAQxC,UAAY,KAAMC,EAAK4E,KAC9DL,GAAOvE,EAAKuE,oCAGpBA,MAAA,iBAK0B/C,KAJtBA,KAAKqD,aAAe,IAAIC,EACxBtD,KAAK8C,OAAOS,GACR,SACAtB,iBACI,IAAM9C,EAAQE,EAAKyD,OAAOU,aAohBnC,SAAgBC,EAAMC,GAC5B,IACC,IAAIC,kBAphBmCtE,EAAKX,MAAMkF,MAAMzE,kBAAhC0E,GACNxE,EAAKyD,OAAO/B,QAAQ+C,mBACpBzE,EAAKyD,OAAO/B,QAAQgD,eAAeF,KAmhBpD,MAAMG,GACP,OAAON,EAAQM,GAEhB,OAAIL,GAAUA,EAAOM,KACbN,EAAOM,UAAK,EAAQP,GAErBC,cAxhBiBK,GAELE,QAAQC,IAAIH,mEARZ,oCAUL,UA5BcpG,qBCLzB,mBAAc,OACVY,sBACK6B,OAAS,CACVxB,MAAO,CACH,CACIC,MAAO,UACPC,MAAO,WAEX,CACID,MAAO,UACPC,MAAO,OACPC,KAAM,WAEV,CAAEF,MAAO,SAAUC,MAAO,IAAKC,KAAM,UACrC,CAAEF,MAAO,SAAUC,MAAO,IAAKC,KAAM,WACrC,CACIF,MAAO,mBACPC,MAAO,uBAEX,CACID,MAAO,mBACPC,MAAO,8CAEX,CACID,MAAO,mBACPC,MAAO,uCAEX,CACID,MAAO,eACPC,MAAO,WAEX,CACID,MAAO,eACPC,MAAO,WAGX,CACID,MAAO,UACPC,MAAO,iBAEX,CACID,MAAO,uBACPC,MAAO,cAEX,CACIY,iBAAiB,IAGzBC,QAAS,CACL,CAAEd,MAAO,2BAA4BC,MAAO,MAC5C,CAAED,MAAO,SAAUC,MAAO,IAAKC,KAAM,SACrC,CAAEa,aAAc,WAEpBC,OAAQ,CACJ,CAAEhB,MAAO,2BAA4BC,MAAO,MAC5C,CAAED,MAAO,SAAUC,MAAO,IAAKC,KAAM,SACrC,CAAEa,aAAc,WAEpBE,QAAS,CACL,CACIjB,MAAO,UACPC,MAAO,OACPC,KAAM,SAEV,CACIa,aAAc,gCArEHU,ICC7BhD,EAGEgD,EADFvC,EACEuC,gBAOF,mBAAe,OACb/B,sBAEKkC,mBAAqB,iBAC1BlC,EAAKmC,kBAAoB,SAEzBnC,EAAKsC,mBAAqB,SAACC,EAASC,EAAYC,GAC9C,IAAIE,EAAOJ,EAAQK,QAAQH,GAE3B,GADiBE,EAAKE,MAAM7C,EAAKkC,oBAO/B,IALA,IAAIY,EAAW,CAAEL,IAAKA,EAAKM,OAAQJ,EAAKK,QACpCC,EAAW,IAAIzD,EAAc+C,EAASO,EAASL,IAAKK,EAASC,QAC7DzC,EAAQ2C,EAASC,kBACjBC,EAAOnD,EAAKmC,kBAET7B,GAAO,CACZ,GAAIA,EAAMK,MAAMkC,MAAMM,GAAO,CAC3B,IAAMC,EAAaH,EAASI,qBAC5B,OAAOtE,EAAMuE,WAAWR,EAAU,CAChCL,IAAKW,EACLL,OAAQE,EAASM,0BAGrBjD,EAAQ2C,EAASO,cAKrB,gCAnCFzB,iBCIA,WAAYuC,EAAQsB,SAAuB,gBAAvBA,IAAAA,GAAgB,IAChC5F,sBACK2E,gBAAkB3E,EAAKF,eAAiBA,EAC7CE,EAAK6E,aAAe,IAAIC,EACxB9E,EAAKsE,OAASA,EACdtE,EAAKD,SAAWuE,EAAO/B,QAAQxC,SAC/BC,EAAK4E,IAAM,eACX5E,EAAKE,MAAQ,IAAIN,EAAMI,EAAKsE,OAAO/B,QAAQxC,UAAY,KAAMC,EAAK4E,KAE7DgB,GAAe5F,EAAKuE,oCAG7BA,MAAA,iBAQ0B/C,KAHtBA,KAAK8C,OAAOS,GACR,SACAtB,iBACI,IAAM9C,EAAQE,EAAKyD,OAAOU,aAohBnC,SAAgBC,EAAMC,GAC5B,IACC,IAAIC,kBAphBmCtE,EAAKX,MAAMkF,MAAMzE,kBAAhC0E,GACNxE,EAAKyD,OAAO/B,QAAQ+C,mBACpBzE,EAAKyD,OAAO/B,QAAQgD,eAAeF,KAmhBpD,MAAMG,GACP,OAAON,EAAQM,GAEhB,OAAIL,GAAUA,EAAOM,KACbN,EAAOM,UAAK,EAAQP,GAErBC,cAxhBiBK,GAELE,QAAQC,IAAIH,mEARZ,oCAUL,UA9BcpG,GCwJvByG,EAAW,eA1Jb,aAeI,OAdKC,EAAWD,WACZC,EAAWD,SAAWrE,MAE1BA,KAAKzB,SAAW,KAChByB,KAAKuE,QAAU,GACfvE,KAAKwE,SAAW,CACZC,SAAU,GACVC,SAAU,cACVC,MAAO,iCAEX3E,KAAK2E,MAAQ3E,KAAKwE,SAASG,MAC3B3E,KAAKyE,SAAWzE,KAAKwE,SAASC,SAC9BzE,KAAK0E,SAAW1E,KAAKwE,SAASE,SAEvBJ,EAAWD,sCAGtBO,iBAAA,SAAiB9B,EAAQ+B,GAErB,IAAMC,EAAMD,EACNA,EAASE,UAAUF,EAASG,QAAQ,MACpC,OACFC,EAAc,KAClB,GAAY,SAARH,EACAG,EAAc,IAAIpH,EAAKiF,WACR,SAARgC,EACPG,EAAc,IAAIC,EAAapC,OAC5B,CACH,IAAMqC,ECpClB,SAA8BC,GAC5B,IAAIN,EAAMM,EAASnG,MAAM,KAAKoG,MAC1BC,EAAS,YAEb,IAAKR,EACH,OAAOQ,EAAS,OAMlB,OAAQR,GACN,IAAK,KACH,OAAOQ,EAAS,aAClB,IAAK,OACH,OAAOA,EAAS,QDqBOC,CAAYV,GACvBW,EAAcnI,EAAIM,QAAQwH,GAAUtH,KAC1CiF,EAAO/B,QAAQ0E,QAAQ,IAAID,GAG/B1C,EAAO/B,QAAQ0E,QAAQR,EAAa,WAChCnC,EAAO/B,QAAQ2E,YAAY7G,MAAM,QAIzC8G,KAAA,SAAKC,EAASC,YAAAA,IAAAA,EAAU,IACpB,IAAIC,EAAK,KAQT,GAPuB,iBAAZF,EACPE,EACIC,SAASC,eAAeJ,IACxBG,SAASE,cAAcL,GACpBA,IAAYA,EAAQM,IAAMN,EAAQO,WACzCL,EAAKF,IAEJE,EAED,OADA5B,QAAQkC,MAAM,gCAAkCN,QAGpD,GAAuB,iBAAZD,EAEP,OADA3B,QAAQkC,MAAM,+BAAiCP,QAInD,IAAI/C,EAAS,KACP/B,EAAU,IAAIvD,EAAYqI,EAAQQ,KAAOR,EAAQQ,KAAO,IA0C9D,OAzCAtF,EAAQxC,SAAWsH,EAAQtH,SAAWsH,EAAQtH,SAAWyB,KAAKzB,SAC9DwC,EAAQuF,eAAe,IAAI7I,IAiB3BqF,EAASzF,EAAIsI,KAAKG,EAAI3F,OAAOoG,OAfN,CACnB9B,SAAUoB,EAAQpB,UAAYzE,KAAKyE,SACnC+B,WAAYX,EAAQnB,UAAY1E,KAAK0E,SACrCC,MAAOkB,EAAQlB,OAAS3E,KAAK2E,MAC7B8B,iBAAiB,EACjBC,UAAU,EACVC,YAAY,EACZC,gBAAgB,EAChBC,SAAU,EACVC,SAAU,OACVC,eAAgB,MAChBC,qBAAqB,EACrBC,iBAAiB,GAG+BpB,KAC7CqB,KAAOrB,EAAQqB,MAAQ,GAC9BpE,EAAOqE,WAAWpG,GAClB+B,EAAOsE,SAASC,gBAAgB,GAAI,GAAI,GAAI,IAC5CvE,EAAOwE,gBAAkBC,SACzBzE,EAAO0E,WAAW,CACdC,cAAe,GACfC,0BAA0B,IAE9B5E,EAAO6E,QAMP3H,KAAK4E,iBAAiB9B,EAAQ+C,EAAQhB,UACtC7E,KAAKuE,QAAQqD,KAAK9E,GAClBD,WAAW,WAGPC,EAAO+E,kBACR,GAEI/E,KAGXgF,MAAA,WACI9H,KAAK+H,SAAW/H,KAAKwE,SAASC,SAC9BzE,KAAKgI,SAAWhI,KAAKwE,SAASE,SAC9B1E,KAAKiI,MAAQjI,KAAKwE,SAASG,SAE/BuD,QAAA,WACIlI,KAAKuE,QAAQ4D,QAAQ,SAACrF,GAClBA,EAAOoF,UACPpF,EAAOsF,UAAUC,qCAGzB,WACI,OAAOpK,qBAoBX,WACI,YAAY0G,WAnBhB,SAAU2D,cACN,GAAKA,EAAL,CAIA,IAAI3D,EAAQ2D,GAAOA,EAAI7I,eAEnBO,KAAK/B,OAAOE,KAAKoB,KACb,SAACgJ,UAASA,EAAK9I,gBAAkBkF,EAAM6D,uBAE3CxI,KAAK/B,OAAOC,MAAMqB,KACd,SAACgJ,UAASA,EAAK9I,gBAAkBkF,EAAM6D,yBAG3CxI,KAAK2E,MAAQ,aAAeA,EAAM8D,QAAQ,OAAQ,KAClDzI,KAAKuE,QAAQ4D,QAAQ,SAACrF,UAAWA,EAAO4F,SAASlK,EAAKmG,eAbtDT,QAAQC,IAAI,uCAmBpB,WACI,YAAYO,cAEhB,SAAavF,GACTa,KAAK0E,SAAWvF,wBAEpB,WACI,YAAYsF,cAEhB,SAAatF,GACTa,KAAKyE,SAAWtF,uBAEpB,WACI,YAAYoF,uMAIpBpE,OAAOwI,OAAOtE"}